{{#section "styles"}}
  <link rel="stylesheet" href="/static/edit.css" />
{{/section}}

<div class="category-edit-container">
  <div class="content-grid single-column">
    <form
      id="frmEditCategory"
      method="post"
      enctype="multipart/form-data"
      class="card shadow-sm category-form-card"
    >
      <div
        class="card-header d-flex justify-content-between align-items-center"
      >
        <h5 class="card-title mb-0">Edit Parent / Child Category</h5>

      </div>

      <div class="card-body">
        <div class="form-grid">
          <!-- PANEL TRÁI: Sửa Parent + công tắc chỉnh Child -->
          <section class="form-panel">

            <!-- Parent name -->
            <div class="form-section">
              <label for="txtParentName" class="form-label">Parent category name</label>
              <input
                type="text"
                class="form-control"
                id="txtParentName"
                name="parentName"
                value="Parent Sample"
                autofocus
              />
              <input
                type="hidden"
                id="parentId"
                name="parentId"
                value="P-101"
              />
            </div>

            <!-- Toggle: chỉnh child -->
            <div class="form-section">
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="toggleChild"
                />
                <label class="form-check-label" for="toggleChild">Edit a child
                  category in this parent</label>
              </div>

            </div>

            <!-- Child picker (chỉ hiện khi bật toggle) -->
            <div class="form-section d-none" id="childPicker">
              <label for="filterChild" class="form-label">Find child in this
                parent</label>
              <input
                type="text"
                id="filterChild"
                class="form-control"
                placeholder="Type to filter (optional)"
              />

              <label for="selChild" class="form-label mt-2">Child category</label>
              <select class="form-select" id="selChild" name="childId"></select>

              <label for="txtChildName" class="form-label mt-3">Child category
                name</label>
              <input
                type="text"
                class="form-control"
                id="txtChildName"
                name="childName"
                value=""
              />

              <input
                type="hidden"
                id="isEditingChild"
                name="isEditingChild"
                value="0"
              />
            </div>
          </section>

          <!-- PANEL PHẢI: Media (ẩn khi không chỉnh child) -->
          <section class="form-panel detail-block d-none" id="panelMedia">
            <div class="panel-header">
              <h6>Media &amp; visibility</h6>
              <p>Upload a cover image and manage how the category appears.</p>
            </div>

            <div class="form-section">
              <label class="form-label" for="fileCover">Category cover</label>
              <div class="media-upload">
                <div class="media-preview">
                  <img
                    src="https://images.unsplash.com/photo-1552664730-d307ca884978?auto=format&fit=crop&w=720&q=80"
                    alt="Category cover preview"
                  />
                </div>
                <div class="media-actions">
                  <p class="media-note">
                    Recommended 1200 × 640 px or larger. Square artwork also
                    works in mobile cards.
                  </p>
                  <div class="media-controls">
                    <label
                      for="fileCover"
                      class="btn btn-outline-primary btn-sm"
                    >
                      <i class="bi bi-upload"></i>
                      Upload image
                    </label>
                    <input
                      type="file"
                      class="d-none"
                      id="fileCover"
                      name="coverImage"
                      accept="image/*"
                    />
                    <input
                      type="url"
                      class="form-control form-control-sm"
                      name="coverImageUrl"
                      value=""
                      placeholder="Or paste an image URL"
                    />
                  </div>
                </div>
              </div>
            </div>

          </section>
        </div>

        <!-- HERO (ẩn khi không chỉnh child) -->
        <section class="form-panel detail-block d-none" id="panelHero">
          <div class="form-section">
            <label for="txtHeroSubtitle" class="form-label">Subtitle </label>
            <textarea
              class="form-control tinymce"
              id="txtHeroSubtitle"
              name="heroSubtitle"
              rows="3"
            >Tiny MCE</textarea>
          </div>
        </section>

        <!-- RICH (ẩn khi không chỉnh child) -->
        <div class="rich-grid detail-block d-none" id="panelRich">
          <section class="rich-panel">
            <div class="panel-header">
              <h6>Course description</h6>
              <p>Provide the long-form overview shown on the category detail
                page.</p>
            </div>
            <textarea
              class="form-control tinymce"
              id="txtDescription"
              name="description"
              rows="6"
            >TinyMCE</textarea>
          </section>

          <section class="rich-panel">
            <div class="panel-header">
              <h6>Benefits when joining</h6>
              <p>List the outcomes or perks learners unlock after enrolling.</p>
            </div>
            <textarea
              class="form-control tinymce"
              id="txtBenefits"
              name="benefits"
              rows="6"
            >TinyMCE</textarea>
          </section>

          <section class="rich-panel wide">
            <div class="panel-header">
              <h6>Curriculum outline</h6>
              <p>Sketch the core modules or playlists powering this category.</p>
            </div>
            <textarea
              class="form-control tinymce"
              id="txtCurriculum"
              name="curriculum"
              rows="6"
            >TinyMCE</textarea>
          </section>
        </div>
      </div>

      <div class="card-footer">
        <div class="action-buttons">
          <a
            class="btn btn-outline-success"
            href="/admin/categories/list"
            role="button"
          >
            <i class="bi bi-arrow-left"></i>
            Back
          </a>
          <div class="secondary-actions">
            <!-- Xóa Parent -->
            <button
              type="submit"
              class="btn btn-outline-danger"
              formaction="/admin/categories/del-parent"
            >
              <i class="bi bi-trash"></i>
              Delete parent
            </button>
            <!-- Xóa Child: chỉ hiện khi đang chỉnh child -->
            <button
              type="submit"
              class="btn btn-danger d-none"
              id="btnDeleteChild"
              formaction="/admin/categories/del-child"
            >
              <i class="bi bi-trash"></i>
              Delete child
            </button>
            <button type="reset" class="btn btn-outline-secondary">
              <i class="bi bi-arrow-counterclockwise"></i>
              Reset
            </button>
            <button
              type="submit"
              class="btn btn-success"
              formaction="/admin/categories/patch"
            >
              <i class="bi bi-check2"></i>
              Save
            </button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>

{{#section "scripts"}}
  <script defer src="/static/edit.js"></script>
{{/section}}